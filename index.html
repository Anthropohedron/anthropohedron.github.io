<!DOCTYPE html>
<html><head>
<meta charset="UTF-8">
<title>Cards Dev</title>
<link rel="stylesheet" type="text/css" href="cards.css">
<link rel="stylesheet" type="text/css" href="smallcards.css">
<link rel="stylesheet" type="text/css" href="largecards.css">
<link rel="stylesheet" type="text/css" href="unicode.css">
<!--[if lt IE 7]>
<link rel="stylesheet" type="text/css" href="/pngHack/pngHack.css">
<![endif]-->
<script language="javascript" type="text/javascript"
	src="combined.js"></script>
<script language="javascript" type="text/javascript"
	src="javascript/seahaven.js"></script>
<script language="javascript" type="text/javascript"
	src="javascript/klondike.js"></script>
<script language="javascript" type="text/javascript">


Event.observe(window, 'load', function() {
  var game = null;

  var gameSelect = $('gameSelect');
  var rulesLink = $('rulesLink');

  Event.observe(gameSelect, 'change', function() {
    var options = gameSelect.options;
    var option = options[gameSelect.selectedIndex];
    var newGame = null;
    if (option.value == "none") return;
    if (option.game) {
      newGame = option.game
    } else {
      newGame = eval('new '+option.value+'("card_game_element", 10, 110);');
      option.game = newGame;
    }
    if (options[0].value=="none") {
      options[0] = null;
    }
    if (game!=newGame) {
      if (game) game.deactivate();
      game = newGame;
      game.activate();
      rulesLink.hash = option.value;
    }
    return;
  });

  var dealing = document.getElementById("dealing");
  var dealFunc = function() {
    game.deal();
    dealing.style.visibility = "hidden";
  };

  Event.observe('deal', 'click', function() {
    if (game) {
      dealing.style.visibility = "visible";
      setTimeout(dealFunc, 100);
    }
  });

  var chooseSize = function(size) {
    size = (""+size).toUpperCase();
    switch(size) {
      case 'LARGE':
        document.body.classList.remove('SMALL');
        document.body.classList.add('LARGE');
        $('largecards').checked = true;
        break;
      case 'SMALL':
        document.body.classList.remove('LARGE');
        document.body.classList.add('SMALL');
        $('smallcards').checked = true;
        break;
    }
    if (game) game.reposition();
    var radio = $(size.toLowerCase()+'cards');
    if (radio) radio.checked = true;
    document.cookie = "preferredSize="+size;
  };

  Event.observe('largecards', 'click', function() { chooseSize('LARGE'); });
  Event.observe('smallcards', 'click', function() { chooseSize('SMALL'); });
  Event.observe('unicode', 'click', function() { document.body.classList.toggle('UNICODE', this.checked); });
  Event.observe('undo', 'click', function() { if (game) game.undo(); });
  Event.observe('redo', 'click', function() { if (game) game.redo(); });

  var getPreferredSize = function() {
    var dc = document.cookie;
    var prefix = "preferredSize=";
    var begin = dc.indexOf("; " + prefix);
    if (begin == -1) {
      begin = dc.indexOf(prefix);
      if (begin != 0) return "LARGE";
    } else
      begin += 2;
    var end = document.cookie.indexOf(";", begin);
    if (end == -1)
      end = dc.length;
    return unescape(dc.substring(begin + prefix.length, end));
  };
  chooseSize(getPreferredSize());
});

</script>
</head><body bgcolor="#CCCCCC" class="LARGE UNICODE">

<form action="#" method="get">
<select id="gameSelect">
<option value="none" SELECTED>select a game
<option value="seahaven">Seahaven Towers
<!--
<option value="klondike">Klondike
-->
</select>
<input type="button" value="Deal" id="deal" />
<input type="button" value="Undo" id="undo" />
<input type="button" value="Redo" id="redo" />
<a href="http://www.allgoodsw.com/sol_rules.html"
  id="rulesLink" TARGET="rules">rules</a><br>
<label for="largecards"><input type="radio" name="cardSize" id="largecards"
value="LARGE" />large cards</label>
<label for="smallcards"><input type="radio" name="cardSize" id="smallcards"
value="SMALL" />small cards</label>
<label for="unicode"><input type="checkbox" name="unicodeFaces" id="unicode"
checked="checked" />Unicode cards</label>
</form>
<span id="dealing" style="color:red; visibility:hidden;">Dealing...</span>
<div id="card_game_element"></div>

</body></html>
